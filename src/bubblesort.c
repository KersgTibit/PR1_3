#include <stdio.h>                          // Подключаем стандартную библиотеку ввода/вывода
#include <stdlib.h>                         // Подключаем стандартную библиотеку для функций выделения памяти

/*
3. **Сортировка пузырьком**: Напишите функцию сортировки пузырьком для массива целых чисел.
*/

int checkenternum(int num){                 // Функция проверки, что число num в диапазоне от 1 до 500
    return (num > 0 && num <= 500);         // Возвращает 1, если да, иначе 0
}

void swap(int* arr, int i, int j) {         // Функция обмена элементов массива arr по индексам i и j
    int temp = arr[i];                       // Сохраняем временно элемент arr[i]
    arr[i] = arr[j];                         // Присваиваем arr[i] значение arr[j]
    arr[j] = temp;                           // Заменяем arr[j] на сохраненный элемент
}

void Bubble_sort(int arr[], int n){          // Функция сортировки массива arr размера n методом пузырька
    for(int i = 0; i < n - 1; i++){          // Внешний цикл проходит до предпоследнего элемента
        for(int j = 0; j < n - i - 1; j++){ // Внутренний цикл проходит по неотсортированной части массива
            if(arr[j] > arr[j + 1]){         // Если текущий элемент больше следующего
                swap(arr, j, j + 1);         // Меняем их местами
            }
        }
    }
}

int main(){
    int n;                                  // Объявляем переменную для размера массива
    printf("Enter number of elements (1-500): ");  // Запрашиваем у пользователя размер массива
    if (scanf("%d", &n) != 1 || !checkenternum(n)) { // Считываем и проверяем корректность ввода
        printf("ERROR: Invalid number of elements.\n"); // При ошибке выводим сообщение и выходим
        return 1;
    }

    int *arr = malloc(n * sizeof(int));     // Выделяем динамическую память под массив из n элементов
    if (!arr) {                             // Если выделение не удалось
        printf("Memory allocation failed.\n"); // Сообщаем об ошибке и завершаем программу
        return 1;
    }

    printf("Enter %d integer elements:\n", n);  // Просим ввести n целых чисел
    for (int i = 0; i < n; i++) {           // Проходимся по массиву для ввода каждого элемента
        if (scanf("%d", &arr[i]) != 1) {    // Считываем число с проверкой корректности ввода
            printf("ERROR: Invalid input. Please enter integers.\n"); // Если неверно, сообщаем
            free(arr);                       // Освобождаем выделенную память
            return 1;                       // Завершаем программу с ошибкой
        }
    }

    Bubble_sort(arr, n);                      // Вызываем функцию сортировки массива

    printf("Sorted array:\n");                // Выводим сообщение о начале вывода отсортированного массива
    for (int i = 0; i < n; i++) {             // Перебираем все элементы отсортированного массива
        printf("%d ", arr[i]);                 // Выводим каждый элемент с пробелом
    }
    printf("\n");                             // Переводим строку после вывода массива

    free(arr);                               // Освобождаем выделенную память под массив
    return 0;                                // Завершаем программу успешно
}

